package wtf.diablo.module.impl.Exploits;

import com.google.common.eventbus.Subscribe;
import lombok.Getter;
import lombok.Setter;
import net.minecraft.network.play.server.S29PacketSoundEffect;
import wtf.diablo.Diablo;
import wtf.diablo.events.EventType;
import wtf.diablo.events.impl.PacketEvent;
import wtf.diablo.gui.notifications.Notification;
import wtf.diablo.gui.notifications.NotificationType;
import wtf.diablo.module.Module;
import wtf.diablo.module.data.Category;
import wtf.diablo.module.data.ServerType;

import java.util.Objects;

@Getter@Setter
public class LightningDetector extends Module {
    public LightningDetector(){
        super("LightningDetector","Detect lightning strikes and output the co-ords", Category.EXPLOIT, ServerType.All);
    }

    @Subscribe
    public void onPacket(PacketEvent e){
        if (e.getType() == EventType.Incoming && e.getPacket() instanceof S29PacketSoundEffect) {
            S29PacketSoundEffect packet = (S29PacketSoundEffect) e.getPacket();
            if (Objects.equals(packet.getSoundName(), "ambient.weather.thunder")) {
                Diablo.getInstance().addNotification(new Notification("Lightning",String.format("Lightning detected at %s, %s, %s",packet.getX(),packet.getY(), packet.getZ()),7500, NotificationType.INFORMATION));
            }
        }
    }
}
